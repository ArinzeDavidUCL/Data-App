<link rel="stylesheet" href="{{ url_for('static', filename='styles/watchlist-styles.css') }}">
<script src="{{ url_for('static', filename='javascript/bootstrap/jquery-3.4.1.js') }}"></script>
<script src="{{ url_for('static', filename='javascript/bootstrap/bootstrap.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='styles/bootstrap/bootstrap.css') }}">
{% extends 'base_layout.html' %}
{% block header %}
  <h1 class="main-heading">{% block title %}Your Watchlist{% endblock %}</h1>
{% endblock %}

{% block content %}
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Quantity</th>
        <th>Average Price</th>
      </tr>
    </thead>
    <tbody>
      {% for item in table1 %}
      <tr class="watchlist-rows">
        <td class="c2">{{item.name}}</td>
        <td class="c3">{{item.quantity}}</td>
        <td class="c3">{{item.price}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% if g.user %}
    <button style=color:black; type="button" class="btn-new-wl"
    data-toggle="modal" data-target="#mymodal">Add to Watchlist</button>
      <div id="mymodal" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title">Add to Watchlist</h4>
            </div>
            <div class="modal-body">
              {% from "_formhelpers.html" import render_field %}
              <form action="{{ url_for('watchlist.create')}}" method="post">
                <dl>
                  {{ render_field(add_form.ticker) }}
                  {{ render_field(add_form.quantity) }}
                  {{ render_field(add_form.price) }}
                  {{ render_field(add_form.sector) }}
                  {{ render_field(add_form.comments) }}
                </dl>
                <button type="submit" name="button">Add</button>
              </form>
            </div>

          </div>
        </div>
      </div>
  {% endif %}
    <table>
      <thead>
        <tr>
          <th>Order ID</th>
          <th>Name</th>
          <th>Quantity</th>
          <th>Price</th>
          <th>Sector</th>
          <th>Date</th>
          <th>comments</th>
          <th>changes?</th>
        </tr>
      </thead>
      <tbody>
        {% for item in watchlist %}
        <tr class="watchlist-rows">
          <td class="c1">{{item.id}}</td>
          <td class="c2">{{item.name}}</td>
          <td class="c3">{{item.quantity}}</td>
          <td class="c4">{{item.price}}</td>
          <td class="c5">{{item.sector}}</td>
          <td class="c6">{{item.created.strftime('%d-%m-%Y')}}</td>
          <td>{{item.comments}}</td>
          <td class="edit-trade">
            {% if g.user['id'] == item['holder_id'] %}
              <button style=color:black; type="button" class="btn-new-wl"
              data-toggle="modal" data-target="#mymodal2{{item.id}}">Edit</button>
                <div id="mymodal2{{item.id}}" class="modal fade" role="dialog">
                  <div class="modal-dialog" id="{{item.id}}">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h4 class="modal-title">Edit</h4>
                      </div>
                      <div class="modal-body">
                        {% from "_formhelpers.html" import render_field %}
                        <form action="{{ url_for('watchlist.update', id=item.id) }}" method="post">
                          <dl>
                            {{ render_field(add_form.quantity) }}
                            {{ render_field(add_form.price) }}
                            {{ render_field(add_form.sector) }}
                            {{ render_field(add_form.comments) }}
                          </dl>
                          <button type="submit" name="button" class="btn btn-primary">Save Changes</button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              <form action="{{ url_for('watchlist.delete', id=item['id']) }}" method="post">
                <input class="danger" type="submit" value="Delete" onclick="return confirm('Are you sure?');">
              </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
{% endblock %}
